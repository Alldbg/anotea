<!DOCTYPE HTML>
<html lang="fr">

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>P&ocirc;le Emploi : Notez et commentez votre formation</title>
        <link rel="icon" type="image/png" href="/static/images/favicon_noteo.ico" />
        <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,900" rel="stylesheet">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
              integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
              crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
                integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
                crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
                integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
                crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
                integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
                crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
        <style>
            .anotea {
                font-size: 1rem;
                font-family: 'Lato', sans-serif;
                font-weight: 400;
                color: black;
                background-color: white;
                min-height: 1000px;
            }

            .card {
                margin-top: 2rem;
                margin-bottom: 2rem;
            }

            td {
                font-size: 0.875rem;
            }
        </style>
    </head>

    <body>
        <section>
            <div class="anotea container">
                <div class="row my-5">
                    <div class="col-sm-12">
                        <h1 class="d-flex justify-content-center">Statistiques Anotea</h1>
                    </div>
                </div>

                <div class="row">
                    <h2>Organismes</h2>
                    <div class="col-sm-12">

                        <div class="card">
                            <div class="card-header">Par région</div>
                            <div class="card-body">
                                <div class="card-text">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th scope="col">Region</th>
                                                <th scope="col">Nombre d'organismes</th>
                                                <th scope="col">Nombre d'organismes actifs</th>
                                                <th scope="col">Organismes avec avis</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% data.organismes.forEach(function(element) { %>
                                                <tr>
                                                    <td><%= element.region %></td>
                                                    <td><%= element.nbOrganimes %></td>
                                                    <td><%= element.nbOrganismesActifs %></td>
                                                    <td><%= element.organismesAvecAuMoinsUnAvis %></td>
                                                </tr>
                                            <% }); %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                Kairos
                            </div>
                            <div class="card-body">

                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">Type</th>
                                            <th scope="col">Nombre d'organismes</th>
                                            <th scope="col">Nombre d'organismes actifs</th>
                                            <th scope="col">Nombre d'organismes ayant au moins un avis</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Kairos</td>
                                            <td><%= data.kairos.nbOrganismes %></td>
                                            <td><%= data.kairos.actifs %></td>
                                            <td><%= data.kairos.hasAtLeastOneAvis %></td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div class="kibana text-center  px-0 py-0">
                                    <div class="embed-responsive embed-responsive-16by9">
                                        <iframe
                                                class="embed-responsive-item"
                                                src="<%= data.kairos.kibanaDashboardUrl %>"
                                        ></iframe>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <h2>Avis</h2>
                    <div class="col-sm-12">
                        <div class="card">
                            <div class="card-header">Par région</div>
                            <div class="card-body">
                                <div class="card-text">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th scope="col">Region</th>
                                                <th scope="col">Nombre d'avis</th>
                                                <th scope="col">Avis restituables Formation</th>
                                                <th scope="col">Avis restituables Action</th>
                                                <th scope="col">Avis restituables Session</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% data.avis.forEach(function(element) { %>
                                                <tr>
                                                    <td><%= element.region %></td>
                                                    <td><%= element.nbAvis %></td>
                                                    <td><%= element.avisRestitutables.apiRouteFormations %></td>
                                                    <td><%= element.avisRestitutables.apiRouteActions %></td>
                                                    <td><%= element.avisRestitutables.apiRouteSessions %></td>
                                                </tr>
                                            <% }); %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <h2>Formations</h2>
                    <div class="col-sm-12">
                        <div class="card">
                            <div class="card-header">Global</div>
                            <div class="card-body">
                                <div class="card-text">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th scope="col">Nombre de formations</th>
                                                <th scope="col">Formations avec au moins un avis</th>
                                                <th scope="col">Formations avec au moins trois avis</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><%= data.formations.nbFormations %></td>
                                                <td><%= data.formations.formationsAvecAuMoinsUnAvis %></td>
                                                <td><%= data.formations.formationsAvecAuMoinsTroisAvis %></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <h2>Sessions</h2>
                    <div class="col-sm-12">
                        <div class="card">
                            <div class="card-header">Par région</div>
                            <div class="card-body">
                                <div class="card-text">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th scope="col">Region</th>
                                                <th scope="col">Nombre de sessions</th>
                                                <th scope="col">Sessions avec au moins un avis</th>
                                                <th scope="col">Sessions avec au moins trois avis</th>
                                                <th scope="col">Sessions certifiantes avec au moins un avis</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% data.sessions.forEach(function(element) { %>
                                                <tr>
                                                    <td><%= element.region %></td>
                                                    <td><%= element.nbSessions %></td>
                                                    <td><%= element.sessionsAvecAuMoinsUnAvis %></td>
                                                    <td><%= element.sessionsAvecAuMoinsTroisAvis %></td>
                                                    <td><%= element.sessionsCertifiantesAvecAvis %></td>
                                                </tr>
                                            <% }); %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <h2>Emails</h2>
                    <div class="col-sm-12">
                        <div class="card">
                            <div class="card-header">Par région</div>
                            <div class="card-body">
                                <div class="card-text">
                                    <table class="table small">
                                        <thead>
                                            <tr>
                                                <th scope="col">Campagne</th>
                                                <th scope="col">Emails envoyés</th>
                                                <th scope="col">Emails ouverts</th>
                                                <th scope="col">Liens cliqués</th>
                                                <th scope="col">Questionnaires validés</th>
                                                <th scope="col">Contact</th>
                                                <th scope="col">Commentaires</th>
                                                <th scope="col">Commentaires rejetés</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <% data.mailing.forEach(function(element) { %>
                                                <tr>
                                                    <td><%= element._id %></td>
                                                    <td><%= element.mailSent %></td>
                                                    <td><%= element.mailOpen %></td>
                                                    <td><%= element.linkClick %></td>
                                                    <td><%= element.formValidated %></td>
                                                    <td><%= element.allowToContact %></td>
                                                    <td><%= element.nbCommentaires %></td>
                                                    <td><%= element.nbCommentairesRejected %></td>
                                                </tr>
                                            <% }); %>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </section>
    </body>

</html>
